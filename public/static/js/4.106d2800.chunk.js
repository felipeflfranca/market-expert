(this["webpackJsonpmarket-expert"]=this["webpackJsonpmarket-expert"]||[]).push([[4],{325:function(e,t,a){"use strict";a.r(t);var c=a(294),n=a(44),r=a.n(n),i=a(317),s=a(49),o=a(19),l=a(236),d=a(102),x=a(173),j=a(34),p=a(226),b=a(72),h=a(320),u=a.n(h),O=a(46),g=a(9),m=a(0),f=a(306),v=a(78),y=a(101),k=a(318),A=a.n(k),C=a(91),F=a(38),T=a(79),w=a.n(T),S=a(327),I=a(326),R=a(329),D=a(328),E=a(319),N=a.n(E),q=a(1),J=Object(s.b)((function(e){return{sales:e.sales}}))((function(e){var t=e.sales,a=e.product,n=e.addToBagVisible,r=e.quantity,i=e.dispatch,s=Object(m.useState)(!1),o=Object(g.a)(s,2),l=o[0],p=o[1],h=Object(m.useState)(!1),u=Object(g.a)(h,2),k=u[0],T=u[1],E=Object(m.useState)(1),J=Object(g.a)(E,2),B=J[0],P=J[1],Q=0,L=0;JSON.parse(a.taxes).map((function(e){var t=Object.keys(e);L+=e[t[0]]}));var V=r?(r*a.value).toFixed(2):a.value;L>0&&(Q=L,L=(V*a.value/100).toFixed(2));var U=function(){p(!1)},z=function(){T(!1)},H=n?Object(q.jsx)(q.Fragment,{children:Object(q.jsxs)("div",{style:{marginTop:"-5px"},children:[Object(q.jsx)(c.a,{style:{textAlign:"left",paddingLeft:"10px"},children:Object(q.jsx)("small",{children:"Quantidade:"})}),Object(q.jsx)(c.a,{children:Object(q.jsxs)(x.a,{component:"form",sx:{display:"flex",alignItems:"center"},children:[Object(q.jsx)(j.c,{sx:{ml:1,flex:1},label:"Quantidade",placeholder:"Quantidade",inputProps:{"aria-label":"Quantidade"},style:{border:"1px solid #cecece",borderRadius:"10px 1px 0px 10px",paddingTop:"8px",paddingBottom:"8px",paddingLeft:"10px",height:"46px"},type:"number",value:B,onChange:function(e){var t=e.target.value?parseInt(e.target.value,10):1;P(t<1?1:t)}}),Object(q.jsx)(b.a,{color:"primary",sx:{p:"10px",color:"secondary.dark"},style:{backgroundColor:"#2196f3",color:"#ffffff",borderRadius:"0px 10px 10px 0px",border:"1px solid #2196f4"},"aria-label":"directions",onClick:function(){var e=B;t.bag["code-".concat(a.code)]&&(e=t.bag["code-".concat(a.code)].quantity+B),t.bag["code-".concat(a.code)]={product:a,quantity:e,total:(e*parseFloat(a.value)).toFixed(2)},i({type:F.a,bag:t.bag})},children:Object(q.jsx)(A.a,{})})]})})]})}):Object(q.jsx)(q.Fragment,{}),M=!r&&n?Object(q.jsx)(q.Fragment,{}):Object(q.jsxs)(q.Fragment,{children:[Object(q.jsxs)(c.a,{item:!0,children:[Object(q.jsxs)(c.a,{item:!0,xs:12,sm:12,md:12,lg:12,xl:12,sx:{textAlign:"right"},children:[Object(q.jsx)("small",{children:"Quantidade:"})," ",Object(q.jsx)("strong",{children:r})]}),Object(q.jsx)(c.a,{item:!0,xs:12,sm:12,md:12,lg:12,xl:12,sx:{textAlign:"right",padding:"0px"},children:Object(q.jsxs)(f.a,{size:"small","aria-label":"small button group",children:[Object(q.jsx)(v.a,{endIcon:Object(q.jsx)(N.a,{sx:{margin:"3px 3px 3px -6px",color:"error.dark"}}),style:{border:"0px"},onClick:function(){T(!0)}}),Object(q.jsx)(v.a,{endIcon:Object(q.jsx)(w.a,{sx:{margin:"3px 3px 3px -6px"}}),style:{border:"0px"},onClick:function(){p(!0)}})]})})]}),Object(q.jsx)(I.a,{open:l,onClose:U,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",id:"dialog-edit",children:Object(q.jsxs)(O.a,{content:!1,style:{textAlign:"center"},title:"EDITAR QUANTIDADE DO PRODUTO NA SACOLA",children:[Object(q.jsx)(S.a,{children:Object(q.jsx)(c.a,{item:!0,xs:12,md:12,children:Object(q.jsx)(d.a,{variant:"h2",children:"".concat(a.code," - ").concat(a.description)})})}),Object(q.jsx)(D.a,{children:Object(q.jsxs)(c.a,{container:!0,spacing:0,children:[Object(q.jsx)(c.a,{item:!0,xs:5,sm:5,md:5,lg:4,xl:4,children:Object(q.jsx)(y.a,{id:"outlined-basic",label:"Quantidade",variant:"outlined",type:"number",minLength:1,sx:{marginRight:"10px",maxWidth:"200px",marginTop:"20px"},style:{textAlign:"left",width:"100%",float:"left"},value:t.bag["code-".concat(a.code)].quantity,onChange:function(e){var c=e.target.value?parseInt(e.target.value,10):1;(c=c<1?1:c)>0&&(t.bag["code-".concat(a.code)]={product:a,quantity:c,total:(c*parseFloat(a.value)).toFixed(2)},i({type:F.a,bag:t.bag}))}})}),Object(q.jsx)(c.a,{item:!0,xs:7,sm:7,md:7,lg:8,xl:8,style:{padding:"0px"},children:Object(q.jsx)(d.a,{variant:"h1",sx:{color:"success.dark"},style:{textAlign:"right",marginTop:"24px"},children:Object(q.jsx)(C.a,{children:V})})})]})}),Object(q.jsx)(R.a,{style:{borderTop:"1px solid #cecece",padding:"10px 10px 10px 0px"},children:Object(q.jsx)(v.a,{variant:"outlined",onClick:U,children:"Fechar"})})]})}),Object(q.jsx)(I.a,{open:k,onClose:z,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",id:"dialog-remove",children:Object(q.jsxs)(O.a,{content:!1,style:{textAlign:"center"},title:"DESEJA REMOVER O PRODUTO DA SACOLA?",children:[Object(q.jsx)(D.a,{style:{padding:"20px"},children:Object(q.jsx)(d.a,{variant:"h2",sx:{pb:5},children:"".concat(a.code," - ").concat(a.description)})}),Object(q.jsxs)(R.a,{style:{borderTop:"1px solid #cecece",padding:"10px 10px 10px 0px"},children:[Object(q.jsx)(v.a,{variant:"outlined",onClick:z,children:"N\xe3o"}),Object(q.jsx)(v.a,{variant:"outlined",color:"error","data-product":a.code,onClick:function(e){var a="code-".concat(e.currentTarget.getAttribute("data-product")),c=Object.keys(t.bag),n=[];c.map((function(e){e!==a&&(n[e]=t.bag[e])})),i({type:F.a,bag:n})},children:"Sim"})]})]})})]});return Object(q.jsx)(q.Fragment,{children:Object(q.jsxs)(c.a,{container:!0,spacing:{xs:2,sm:0,md:2,lg:0},columns:{xs:12,sm:12,md:12,lg:12},children:[Object(q.jsx)(c.a,{item:!0,xs:12,sm:12,md:8,lg:8,xl:9,children:Object(q.jsx)(c.a,{container:!0,alignItems:"center",justifyContent:"space-between",children:Object(q.jsxs)(c.a,{item:!0,children:[Object(q.jsxs)(d.a,{variant:n?"h3":"subtitle1",color:"inherit",children:[Object(q.jsx)("strong",{children:a.code})," - ",a.description]}),Object(q.jsxs)(d.a,{variant:"subtitle2",children:["Impostos: ",Object(q.jsx)(C.a,{children:Q*V/100})]}),Object(q.jsx)(d.a,{variant:n?"h4":"subtitle1",sx:{color:"success.dark"},children:Object(q.jsx)(C.a,{children:V})})]})})}),Object(q.jsxs)(c.a,{item:!0,xs:12,sm:12,md:4,lg:4,xl:3,sx:{textAlign:"right"},children:[H,M]})]},a.code)})})),B=Object(s.b)((function(e){return{search:e.sales}}))((function(e){var t=e.search,a=e.dispatch;function n(){return(n=Object(i.a)(r.a.mark((function e(t){var c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c={method:"GET",redirect:"follow"},fetch("http://".concat(o.a.host,":").concat(o.a.port,"/services?api=product&search=").concat(t),c).then((function(e){return e.text()})).then((function(e){var c=JSON.parse(e);a({type:F.c,products:c.data,search:t})})).catch((function(e){return console.log("error",e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var s=function(){a({type:F.c,products:[],search:""})};return Object(q.jsxs)(O.a,{sx:{height:"calc(100vh - 131px)",position:"relative"},children:[Object(q.jsx)(c.a,{item:!0,xs:12,children:Object(q.jsxs)(x.a,{component:"form",sx:{p:"2px 4px",display:"flex",alignItems:"center",width:"100%",border:"1px solid #c7c7c7"},children:[Object(q.jsx)(j.c,{sx:{ml:1,flex:1,width:"100%"},placeholder:"Buscar produto",inputProps:{"aria-label":"Buscar Produto"},value:t.search,onChange:function(e){var t=e.target.value;""===t?s():function(e){n.apply(this,arguments)}(t)},autoFocus:!0}),Object(q.jsx)(p.a,{sx:{height:28,m:.5},orientation:"vertical"}),Object(q.jsx)(b.a,{color:"primary",sx:{p:"10px"},"aria-label":"directions",type:"button",onClick:s,children:Object(q.jsx)(u.a,{})})]})}),Object(q.jsx)(c.a,{item:!0,xs:12,style:{marginTop:"10px"},children:Object(q.jsx)(l.a,{style:{maxHeight:"calc(80vh - 60px)",overflow:"auto",marginTop:"10px 10px 10px 10px",padding:"10px 10px 10px 10px"},children:Array.isArray(t.products)?t.products.map((function(e){return Object(q.jsxs)("div",{children:[Object(q.jsx)(J,{product:e,addToBagVisible:!0,quantity:0},e.code),Object(q.jsx)(p.a,{sx:{my:1.5}})]},"search-".concat(e.code))})):Object(q.jsx)(d.a,{variant:"h1",children:t.products})})})]})})),P=a(237),Q=a(330),L=a(148),V=a.n(L),U=a(80),z=a.n(U),H=Object(s.b)((function(e){return{products:e.sales}}))((function(e){var t=e.products,a=e.dispatch,n=Object(m.useState)(0),r=Object(g.a)(n,2),i=r[0],s=r[1],x=Object(m.useState)(0),j=Object(g.a)(x,2),b=j[0],h=j[1],u=Object(m.useRef)(!1);Object(m.useEffect)((function(){if(u.current){for(var e=Object.keys(t.bag),a=0,c=0,n=0;n<e.length;n++){var r=t.bag[e[n]];c+=parseFloat(r.total);for(var i=0,o=JSON.parse(r.product.taxes),l=0;l<o.length;l++){var d=o[l];i+=d[Object.keys(d)]}a+=i*r.total/100}s(a),h(c)}else u.current=!0}));var f=(t.bag?Object.keys(t.bag):[]).map((function(e){var a=t.bag[e].quantity,c=t.bag[e].product;return Object(q.jsxs)("div",{children:[Object(q.jsx)(J,{product:c,addToBagVisible:!1,quantity:a},c.code),Object(q.jsx)(p.a,{sx:{my:1.5}})]},"search-".concat(c.code))}));return Object(q.jsxs)(q.Fragment,{children:[Object(q.jsxs)(O.a,{content:!1,style:{height:"calc(100vh - 195px)",position:"relative"},children:[Object(q.jsx)(c.a,{item:!0,xs:12,children:Object(q.jsx)(l.a,{style:{maxHeight:"calc(80vh - 110px)",overflow:"auto",display:"flex",flexDirection:"column-reverse"},children:Object(q.jsx)(P.a,{children:f})})}),Object(q.jsxs)(c.a,{item:!0,xs:12,sx:{p:1.25,pt:0,justifyContent:"center",bottom:0,position:"absolute",width:"100%"},children:[Object(q.jsxs)(d.a,{variant:"subtitle1",color:"inherit",children:["Impostos:",Object(q.jsx)("span",{style:{float:"right"},children:Object(q.jsx)(C.a,{children:i.toFixed(2)})})]}),Object(q.jsxs)(d.a,{variant:"h1",color:"inherit",children:["Total:",Object(q.jsx)("span",{style:{float:"right"},children:Object(q.jsx)(C.a,{children:b.toFixed(2)})})]})]})]}),Object(q.jsx)(O.a,{content:!1,sx:{height:"65px",position:"relative"},children:Object(q.jsx)(c.a,{item:!0,xs:12,children:Object(q.jsx)(Q.a,{sx:{p:1.25,pt:0},style:{justifyContent:"center",bottom:0,position:"absolute",width:"100%"},children:Object(q.jsxs)(v.a,{variant:"contained",size:"large",disableElevation:!0,sx:{width:"100%"},disabled:!b,onClick:function(){for(var e=Object.keys(t.bag),c=[],n=0;n<e.length;n++){var r=t.bag[e[n]];c.push(r)}var i=new FormData;i.append("data",JSON.stringify(c));var s={method:"POST",body:i,redirect:"follow"};fetch("http://".concat(o.a.host,":").concat(o.a.port,"/services?api=sales"),s).then((function(e){return e.text()})).then((function(e){var t=JSON.parse(e);z.a.fire({icon:t.status,title:t.data.message,showConfirmButton:!1,timer:1800}),a({type:F.a,bag:[]}),a({type:F.c,products:[],search:""})})).catch((function(e){return console.log("error",e)}))},children:["FINALIZAR COMPRA",Object(q.jsx)(V.a,{})]})})})})]})}));t.default=function(){return Object(q.jsxs)(c.a,{container:!0,children:[Object(q.jsx)(c.a,{item:!0,xs:12,md:8,children:Object(q.jsx)(B,{})}),Object(q.jsx)(c.a,{item:!0,xs:12,md:4,children:Object(q.jsx)(H,{})})]})}}}]);
//# sourceMappingURL=4.106d2800.chunk.js.map